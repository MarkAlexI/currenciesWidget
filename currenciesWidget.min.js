"use strict";const DEFAULT_BOTTOM=5,DEFAULT_RIGHT=2,MAX_RIGHT=Math.floor((window.innerWidth-150)/16),MAX_BOTTOM=Math.floor((window.innerHeight-410)/16),DEFAULT_BASE="USD",DEFAULT_TSYMS="USD,JPY,EUR",CURRENCIES_LIST="UAH, EUR, USD, GBP, JPY, AUD, CAD, CHF, OMR, NZD, PLN, HKD, CNY, MYR, BTC, ETH, DOGE, USDT, USDC, BNB, XRP, ADA";let BASE=localStorage.getItem("BASE")||"USD",TSYMS=localStorage.getItem("TSYMS")||"USD,JPY,EUR",BOTTOM=localStorage.getItem("BOTTOM")||5,RIGHT=localStorage.getItem("RIGHT")||2;const createSelect=(e,n=!1)=>`<select\n      id="${e}"\n      class="hidden"\n      ${n?'multiple=""':""}\n    />\n      <option value="">--Choose currency</option>\n      ${CURRENCIES_LIST.split(", ").map((e=>`<option value="${e}">${e}</option>`)).join("")}\n    </select>\n  `,enterToDialog=document.body.appendChild(document.createElement("div"));enterToDialog.innerHTML=`\n<style>\n  #currency_widget_dialog {\n    display: grid;\n    gap: 1.2rem;\n    background-color: lime;\n    z-index: 10;\n    margin-top: 10 px;\n    border-radius: 1rem;\n  }\n  #currency_widget_dialog:not([open]) {\n    pointer-events: none;\n    opacity: 0;\n  }\n  #currency_widget_dialog::backdrop {\n    background-color: hsl(250, 100%, 50%, 0.25);\n  }\n  @media (prefers-color-scheme: dark) {\n    #currency_widget_dialog {\n      background: pink;\n    }\n  }\n  .hidden {\n    display: none;\n  }\n  button[id*="btn"] {\n    height: 1.8rem;\n    border: 1px black solid;\n    border-radius: 5%;\n    background-color: lightgrey;\n    color: blue;\n    cursor: pointer;\n  }\n  #currency_widget_field {\n    position: fixed;\n    bottom: ${BOTTOM}rem;\n    right: ${RIGHT}rem;\n    z-index: 10;\n    border: 1px solid black;\n  }\n  #currency_widget_settings {\n    margin: 0;\n    padding: .1rem .4rem 0 .4rem;\n    height: 1.3rem;\n    display: flex;\n    flex-direction: column;\n    row-gap: .3rem;\n    justify-content: start;\n    align-items: start;\n    background-color: lightcyan;\n    overflow: hidden;\n  }\n  #currency_widget_settings.open {\n    height: 17rem;\n  }\n  #currency_widget_settings_triangle {\n    width: 0;\n    height: 0;\n    border-left: .5rem solid transparent;\n    border-right: .5rem solid transparent;\n    border-top: 1rem solid black;\n  }\n  :is(#currency_widget_settings.open) #currency_widget_settings_triangle {\n    border-bottom: 1rem solid black;\n    border-top: 0;\n  }\n  #currency_widget_settings_move {\n    display: flex;\n    gap: .6rem;\n  }\n  button[id*="arrow"] {\n    height: 1.8rem;\n    border: 2px black solid;\n    border-radius: 10%;\n    background-color: smokewhite;\n    color: black;\n    font-weight: bold;\n    cursor: pointer;\n  }\n  #currency_widget_field table {\n    width: 9rem;\n    border-collapse: collapse;\n    border: 1 px solid black;\n    text-align: center;\n    vertical-align: middle;\n  }\n  #currency_widget_data tr:nth-child(odd) {\n    background-color: linen;\n  }\n</style>\n<dialog\n  id="currency_widget_dialog"\n>\n  <form id="currency_widget_form">\n    <input\n      id="currency_widget_input"\n      type="text"\n      placeholder="Print your API-key"\n    />\n    ${createSelect("currency_widget_select")}\n    ${createSelect("currency_widget_multi_select",!0)}\n    <button\n      autofocus\n      id="currency_widget_left_btn"\n      formmethod="dialog"\n      type="submit"\n    >Cancel</button>\n    <button\n      id="currency_widget_right_btn"\n      type="submit"\n    >Submit</button>\n  </form>\n</dialog>\n<div id="currency_widget_field">\n  <div id="currency_widget_settings">\n    <div id="currency_widget_settings_triangle"></div>\n    <p>Move:</p>\n      <div id="currency_widget_settings_move">\n        <button\n          id="currency_widget_settings_move_left_arrow"\n        >&larr;</button>\n        <button\n          id="currency_widget_settings_move_up_arrow"\n        >&uarr;</button>\n        <button\n          id="currency_widget_settings_move_right_arrow"\n        >&rarr;</button>\n        <button\n          id="currency_widget_settings_move_bottom_arrow"\n        >&darr;</button>\n      </div>\n    <p>Change:</p>\n    <button id="currency_widget_api_btn">\n      API-key\n    </button>\n    <button id="currency_widget_base_btn">\n      BASE currency\n    </button>\n    <button id="currency_widget_courses_btn">\n     List of currencies\n    </button>\n  </div>\n  <table>\n    <tbody id="currency_widget_data">\n      \n    </tbody>\n  </table>\n</div>\n`;const getById=e=>document.getElementById(e),dialog=getById("currency_widget_dialog"),input=getById("currency_widget_input"),leftBtn=getById("currency_widget_left_btn"),rightBtn=getById("currency_widget_right_btn"),field=getById("currency_widget_field"),data=getById("currency_widget_data"),select=getById("currency_widget_select"),multiSelect=getById("currency_widget_multi_select"),settings=getById("currency_widget_settings"),triangle=getById("currency_widget_settings_triangle"),leftArrow=getById("currency_widget_settings_move_left_arrow"),upArrow=getById("currency_widget_settings_move_up_arrow"),rightArrow=getById("currency_widget_settings_move_right_arrow"),downArrow=getById("currency_widget_settings_move_bottom_arrow"),changeApiKeyBtn=getById("currency_widget_api_btn"),changeBaseBtn=getById("currency_widget_base_btn"),changeCoursesBtn=getById("currency_widget_courses_btn");triangle.addEventListener("click",(()=>{settings.classList.toggle("open")}));const openDialog=()=>!dialog.open&&dialog.showModal(),closeDialog=()=>dialog.close();let savedKey=localStorage.getItem("key")||"";const saveLocal=(e,n)=>localStorage.setItem(e,n),newStyleValue=e=>"left"===e?Math.min(MAX_RIGHT,RIGHT+1):"right"===e?Math.max(0,RIGHT-1):"up"===e?Math.min(MAX_BOTTOM,BOTTOM+1):"down"===e?Math.max(0,BOTTOM-1):void 0,render=e=>{"left"===e||"right"===e?(RIGHT=newStyleValue(e),saveLocal("RIGHT",RIGHT),field.style.right=`${RIGHT}rem`):(BOTTOM=newStyleValue(e),saveLocal("BOTTOM",BOTTOM),field.style.bottom=`${BOTTOM}rem`)},moveLeft=()=>render("left"),moveRight=()=>render("right"),moveUp=()=>render("up"),moveDown=()=>render("down");leftArrow.addEventListener("click",moveLeft),rightArrow.addEventListener("click",moveRight),upArrow.addEventListener("click",moveUp),downArrow.addEventListener("click",moveDown);const changeTextOnBaseBtn=()=>changeBaseBtn.innerHTML=`BASE currency: ${BASE}`;changeTextOnBaseBtn();const takeFromInput=()=>{if(input.value&&(savedKey=input.value,input.value="",saveLocal("key",savedKey)),select.value&&(BASE=select.value,saveLocal("BASE",select.value),changeTextOnBaseBtn()),multiSelect.value){const e=document.getElementById("currency_widget_multi_select").selectedOptions,n=Array.from(e).map((({value:e})=>e)).filter((e=>"--Choose currency"!==e));TSYMS=n.join(","),saveLocal("TSYMS",TSYMS)}closeDialog(),getCources()},changeApiKey=()=>{openDialog(),input.classList.remove("hidden"),select.classList.add("hidden"),multiSelect.classList.add("hidden")},changeBase=()=>{openDialog(),input.classList.add("hidden"),multiSelect.classList.add("hidden"),select.classList.remove("hidden")},changeCourses=()=>{openDialog(),input.classList.add("hidden"),multiSelect.classList.remove("hidden"),select.classList.add("hidden")};leftBtn.addEventListener("click",closeDialog),rightBtn.addEventListener("click",takeFromInput),changeApiKeyBtn.addEventListener("click",changeApiKey),changeBaseBtn.addEventListener("click",changeBase),changeCoursesBtn.addEventListener("click",changeCourses);const getResponse=e=>{let n="";Object.keys(e).map((t=>{n+=`\n        <tr>\n          <td>${t}</td>\n          <td>${(1/e[t]).toFixed(3)}</td>\n        </tr>\n      `})),data.innerHTML=n},getCources=()=>{fetch(`https://min-api.cryptocompare.com/data/price?fsym=${BASE}&tsyms=${TSYMS}&api_key={${savedKey}}`,{credentials:"omit"}).then((e=>e.json())).then(getResponse).catch((e=>{console.log(e)}))};getCources(),document.getElementById("currency_widget_form").addEventListener("submit",(function(e){return e.preventDefault(),window.history.back(),(input.value||select.value||multiSelect.value)&&getCources(),!1}));
